{% extends "base.html" %} {% block content %}
<h1>Admin Dashboard</h1>

<ul class="nav nav-tabs" id="adminTabs" role="tablist">
  <li class="nav-item" role="presentation">
    <button
      class="nav-link active"
      id="users-tab"
      data-bs-toggle="tab"
      data-bs-target="#users"
      type="button"
      role="tab"
      aria-controls="users"
      aria-selected="true"
    >
      Quản lý người dùng
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button
      class="nav-link"
      id="history-tab"
      data-bs-toggle="tab"
      data-bs-target="#history"
      type="button"
      role="tab"
      aria-controls="history"
      aria-selected="false"
    >
      Lịch sử dịch
    </button>
  </li>
</ul>

<div class="tab-content" id="adminTabsContent">
  <div
    class="tab-pane fade show active"
    id="users"
    role="tabpanel"
    aria-labelledby="users-tab"
  >
    <table class="table table-bordered table-striped table-hover">
      <thead>
        <tr>
          <th class="text-center">Tên đăng nhập</th>
          <th class="text-center">Admin</th>
          <th class="text-center">Số lần dịch còn lại</th>
          <th class="text-center">Whitelist</th>
          <th class="text-center">Hành động</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
        <tr>
          <td>{{ user.username }}</td>
          <td class="text-center">{{ 'Có' if user.is_admin else 'Không' }}</td>
          <td class="text-center">{{ user.remaining_translations }}</td>
          <td class="text-center">
            {{ 'Có' if user.is_whitelisted else 'Không' }}
          </td>
          <td class="text-center">
            {% if not user.is_admin %} {% if user.is_whitelisted %}
            <form
              method="POST"
              action="{{ url_for('toggle_whitelist', user_id=user.id) }}"
            >
              <input type="hidden" name="action" value="remove" />
              <input
                type="submit"
                value="Xóa khỏi whitelist"
                class="btn btn-danger btn-sm"
              />
            </form>
            {% else %}
            <form
              method="POST"
              action="{{ url_for('toggle_whitelist', user_id=user.id) }}"
            >
              <input type="hidden" name="action" value="add" />
              <input
                type="submit"
                value="Thêm vào whitelist"
                class="btn btn-success btn-sm"
              />
            </form>
            {% endif %} {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div
    class="tab-pane fade"
    id="history"
    role="tabpanel"
    aria-labelledby="history-tab"
  >
    <table class="table table-bordered table-striped table-hover">
      <thead>
        <tr>
          <th class="text-center" style="width: 15%">Thời gian</th>
          <th class="text-center" style="width: 20%">Văn bản gốc</th>
          <th class="text-center" style="width: 65%">Kết quả</th>
        </tr>
      </thead>
      <tbody>
        {% for item in history %}
        <tr>
          <td class="text-center">{{ item.created_at }}</td>
          <td>{{ item.input_text }}</td>
          <td>{{ item.result }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
